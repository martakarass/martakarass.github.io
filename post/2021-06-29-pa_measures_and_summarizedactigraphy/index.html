<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Marta Karas">

  
  
  
    
  
  <meta name="description" content="In this post, we:


use dataset “Labeled raw accelerometry data captured during walking,
stair climbing and driving” that is freely available on PhysioNet;


derive four minute-level summary measures of physical activity – AC,
MIMS, MAD, AI – from raw accelerometry data using
SummarizedActigraphy R package;


summarize minute-level summary measures across walking and driving
activities.

">

  
  <link rel="alternate" hreflang="en-us" href="/post/2021-06-29-pa_measures_and_summarizedactigraphy/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111897145-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-111897145-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/post/2021-06-29-pa_measures_and_summarizedactigraphy/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Home">
  <meta property="og:url" content="/post/2021-06-29-pa_measures_and_summarizedactigraphy/">
  <meta property="og:title" content="Computing minute-level summary measures of physical activity from raw accelerometry data in R: AC, MIMS, MAD, and AI | Home">
  <meta property="og:description" content="In this post, we:


use dataset “Labeled raw accelerometry data captured during walking,
stair climbing and driving” that is freely available on PhysioNet;


derive four minute-level summary measures of physical activity – AC,
MIMS, MAD, AI – from raw accelerometry data using
SummarizedActigraphy R package;


summarize minute-level summary measures across walking and driving
activities.

"><meta property="og:image" content="/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-07-10T17:19:28-04:00">
    
    <meta property="article:modified_time" content="2021-07-10T17:19:28-04:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/2021-06-29-pa_measures_and_summarizedactigraphy/"
  },
  "headline": "Computing minute-level summary measures of physical activity from raw accelerometry data in R: AC, MIMS, MAD, and AI",
  
  "datePublished": "2021-07-10T17:19:28-04:00",
  "dateModified": "2021-07-10T17:19:28-04:00",
  
  "author": {
    "@type": "Person",
    "name": "Marta Karas"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Home",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "\u003cp\u003eIn this post, we:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003euse dataset “Labeled raw accelerometry data captured during walking,\nstair climbing and driving” that is freely available on PhysioNet;\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ederive four minute-level summary measures of physical activity – AC,\nMIMS, MAD, AI – from raw accelerometry data using\n\u003ccode\u003eSummarizedActigraphy\u003c/code\u003e R package;\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003esummarize minute-level summary measures across walking and driving\nactivities.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e"
}
</script>

  

  


  


  





  <title>Computing minute-level summary measures of physical activity from raw accelerometry data in R: AC, MIMS, MAD, and AI | Home</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
    <script>window.wcDarkLightEnabled = true;</script>
  
  
    <script>const isSiteThemeDark = false;</script>
  
  
  <script src="/js/load-theme.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Home</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Home</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#resources"><span>Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/docs/mkaras_cv.pdf"><span>CV</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Computing minute-level summary measures of physical activity from raw accelerometry data in R: AC, MIMS, MAD, and AI</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Jul 10, 2021
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    12 min read
  </span>
  

  
  
  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>In this post, we:</p>
<ul>
<li>
<p>use dataset “Labeled raw accelerometry data captured during walking,
stair climbing and driving” that is freely available on PhysioNet;</p>
</li>
<li>
<p>derive four minute-level summary measures of physical activity – AC,
MIMS, MAD, AI – from raw accelerometry data using
<code>SummarizedActigraphy</code> R package;</p>
</li>
<li>
<p>summarize minute-level summary measures across walking and driving
activities.</p>
</li>
</ul>
<h2>Table of Contents</h2>
<nav id="TableOfContents">
  <ul>
    <li><a href="#dataset-labeled-raw-accelerometry-data">Dataset “Labeled raw accelerometry data”</a></li>
    <li><a href="#computing-minute-level-summary-measures-of-raw-accelerometry-data">Computing minute-level summary measures of raw accelerometry data</a>
      <ul>
        <li><a href="#summary-measures">Summary measures</a></li>
        <li><a href="#summarizedactigraphy-r-package">SummarizedActigraphy R package</a></li>
        <li><a href="#preparing-the-data-input">Preparing the data input</a></li>
        <li><a href="#computing-the-measures">Computing the measures</a></li>
      </ul>
    </li>
    <li><a href="#minute-level-physical-activity-measures-during-walking-and-driving-activities">Minute-level physical activity measures during walking and driving activities</a>
      <ul>
        <li><a href="#merging-physical-activity-measures-with-physical-activity-labels">Merging physical activity measures with physical activity labels</a></li>
        <li><a href="#visualizing-physical-activity-measures-across-activity-types">Visualizing physical activity measures across activity types</a></li>
      </ul>
    </li>
    <li><a href="#acknowledgements">Acknowledgements</a></li>
    <li><a href="#span-stylecolorredcitation-infospan"><span style="color:red">Citation info</span></a></li>
  </ul>
</nav>
<h2 id="dataset-labeled-raw-accelerometry-data">Dataset “Labeled raw accelerometry data”</h2>
<p>The dataset contains raw accelerometry data collected during outdoor
walking, stair climbing, and driving for n=32 healthy adults. It is
freely is available to download on PhysioNet at:
<a href="https://doi.org/10.13026/51h0-a262">https://doi.org/10.13026/51h0-a262</a></p>
<ul>
<li>The study was led by Dr. Jaroslaw Harezlak, assisted by Drs. William
Fadel and Jacek Urbanek.</li>
<li>Accelerometry data were collected simultaneously at four body
locations: left wrist, left hip, left ankle, and right ankle, at a
sampling frequency of 100 Hz.</li>
<li>The 3-axial ActiGraph GT3X+ devices were used to collect the data.</li>
<li>The data include labels of activity type performed for each time
point of data collection (1=walking; 2=descending stairs;
3=ascending stairs; 4=driving; 77=clapping; 99=non-study activity).</li>
</ul>
<p>We downloaded the data zip from PhysioNet and unpacked. This can be done
manually from the website, or using download the data programmatically.</p>
<details>
<summary>
(Click to see the code to download the data.)
</summary>
<pre><code>url &lt;- paste0(
  &quot;https://physionet.org/static/published-projects&quot;,
  &quot;/accelerometry-walk-climb-drive&quot;,
  &quot;/labeled-raw-accelerometry-data-captured-during-walking-stair-climbing-and-driving-1.0.0.zip&quot;)
destfile &lt;- paste0(
  &quot;/Users/martakaras/Downloads&quot;,
  &quot;/labeled-raw-accelerometry-data-captured-during-walking-stair-climbing-and-driving-1.0.0.zip&quot;)
# download zip
result &lt;- curl::curl_download(url, destfile = destfile, quiet = FALSE)
# unzip zip 
unzip(zipfile = destfile, exdir = dirname(destfile))
</code></pre>
</details>
</br>
<p>First, let’s look at raw accelerometry data of a single subject.</p>
<details>
<summary>
(Click to see the code.)
</summary>
<pre><code>library(tidyverse)
library(lubridate)
library(lme4)
library(knitr)
# remotes::install_github(&quot;muschellij2/SummarizedActigraphy&quot;)
library(SummarizedActigraphy)
library(MIMSunit)
library(activityCounts)
options(digits.secs = 3)
options(scipen=999)

# define path to raw data files directory
raw_files_dir &lt;- paste0(
  &quot;/Users/martakaras/Downloads&quot;,
  &quot;/labeled-raw-accelerometry-data-captured-during-walking-stair-climbing-and-driving-1.0.0&quot;,
  &quot;/raw_accelerometry_data&quot;)

# single participant's raw accelerometry data
dat_fpaths &lt;- list.files(raw_files_dir, full.names = TRUE)
dat_i &lt;- read_csv(dat_fpaths[1])
</code></pre>
</details>
<pre><code>dat_i

# A tibble: 303,300 x 14
   activity time_s   lw_x   lw_y   lw_z   lh_x   lh_y   lh_z   la_x  la_y   la_z   ra_x  ra_y  ra_z
      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1       99   0.01  0.039  1.02  -0.02  -0.18   1.23   0.023  0.156 0.855 -0.582  0.887 0.449 0.074
 2       99   0.02 -0.629 -0.461  0.973 -0.246  0.137  0.969 -0.707 0.559  0.449 -0.027 0.141 0.934
 3       99   0.03 -0.926 -1.26   0.691  0.238 -0.328  1.22  -1.44  1.37   0.367 -0.164 0.66  1.34 
 4       99   0.04 -0.871 -1.50  -0.246  0.711 -0.484  0.414 -1.66  1.64  -0.543 -0.141 1.03  0.707
 5       99   0.05 -0.727 -1.62  -0.559  1.03  -0.297  0.145 -1.76  1.68  -0.918 -0.121 1.23  0.438
 6       99   0.06 -0.543 -1.66  -0.629  1.12  -0.246  0.137 -1.80  1.65  -0.988 -0.051 1.42  0.371
 7       99   0.07 -0.348 -1.64  -0.609  1.24  -0.426  0.047 -1.76  1.57  -0.992  0.09  1.63  0.383
 8       99   0.08 -0.16  -1.60  -0.566  1.18  -0.539 -0.008 -1.63  1.53  -1.02   0.25  1.83  0.387
 9       99   0.09 -0.012 -1.53  -0.523  1.03  -0.633 -0.043 -1.13  1.87  -0.738  0.363 2     0.328
10       99   0.1   0.117 -1.43  -0.484  0.922 -0.766 -0.047  0.285 1.37  -0.156  0.473 2.13  0.203
# … with 303,290 more rows
</code></pre>
<p>Each file contains 14 variables:</p>
<ul>
<li><code>activity</code> – type of activity (1=walking; 2=descending stairs;
3=ascending stairs; 4=driving; 77=clapping; 99=non-study activity);</li>
<li><code>time_s</code> – time from device initiation (seconds [s]);</li>
<li><code>lw_x</code>, <code>lw_y</code>, <code>lw_z</code> – acceleration [<em>g</em>] measured by a left
wrist-worn sensor at axis x, y, z;</li>
<li><code>lh_x</code>, <code>lh_y</code>, <code>lh_z</code> – acceleration [<em>g</em>] measured by a left
hip-worn sensor at axis x, y, z;</li>
<li><code>la_x</code>, <code>la_y</code>, <code>la_z</code> – acceleration [<em>g</em>] measured by a left
ankle-worn sensor at axis x, y, z;</li>
<li><code>ra_x</code>, <code>ra_y</code>, <code>ra_z</code> – acceleration [<em>g</em>] measured by a right
ankle-worn sensor at axis x, y, z.</li>
</ul>
<p>An exemplary few seconds of raw data from of walking and driving
activities, collected by sensors at four different locations:</p>
<details>
<summary>
(Click to see the code.)
</summary>
<pre><code>loc_id_levels &lt;- c(&quot;lw&quot;, &quot;lh&quot;, &quot;la&quot;, &quot;ra&quot;)
loc_id_labels &lt;- c(&quot;left wrist&quot;, &quot;left hip&quot;, &quot;left ankle&quot;, &quot;right ankle&quot;)
activity_levels &lt;- c(&quot;walking&quot;, &quot;driving&quot;)
plt_df &lt;- 
  dat_i %&gt;%
  filter(activity %in% c(1,4)) %&gt;%
  group_by(activity) %&gt;%
  mutate(time_s = time_s - min(time_s)) %&gt;%
  ungroup() %&gt;%
  filter(time_s &gt;= (5 + 5), time_s &lt; (5 + 10)) %&gt;%
  mutate(activity = recode(activity, '1' = 'walking', '4' = 'driving')) %&gt;%
  pivot_longer(cols = -c(activity, time_s)) %&gt;%
  separate(name, c(&quot;loc_id&quot;, &quot;axis_id&quot;), sep = &quot;_&quot;) %&gt;%
  mutate(activity = factor(activity, levels = activity_levels)) %&gt;%
  mutate(loc_id = factor(loc_id, levels = loc_id_levels, labels = loc_id_labels)) 
plt_raw_data &lt;- 
  ggplot(plt_df, aes(x = time_s, y = value, color = axis_id)) + 
  geom_line() + 
  facet_grid(loc_id ~ activity) + 
  scale_y_continuous(limits = c(-1, 1) * max(abs(plt_df$value))) + 
  labs(y = &quot;Acceleration [g]&quot;,
       x = &quot;Time since activity started [s]&quot;,
       color = &quot;Sensor axis: &quot;) + 
  theme_gray(base_size = 14) + 
  theme(legend.position=&quot;bottom&quot;) + 
  scale_color_manual(values = c(&quot;red&quot;, &quot;darkgreen&quot;, &quot;blue&quot;))
</code></pre>
</details>
<pre><code>plt_raw_data
</code></pre>
<p><img src="plt_raw_data.png" alt=""></p>
<h2 id="computing-minute-level-summary-measures-of-raw-accelerometry-data">Computing minute-level summary measures of raw accelerometry data</h2>
<h3 id="summary-measures">Summary measures</h3>
<p>A number of open-source measures have been proposed to aggregate
subsecond-level accelerometry data. These include:</p>
<ul>
<li>Monitor Independent Movement Summary (MIMS) (<a href="https://journals.humankinetics.com/view/journals/jmpb/2/4/article-p268.xml" target="_blank" rel="noopener">John et al.,
2019</a>),
<!-- - Euclidean Norm Minus One (ENMO) ([van Hees et al., 2013](https://pubmed.ncbi.nlm.nih.gov/25103964/)),  -->
</li>
<li>Mean Amplitude Deviation (MAD) (<a href="https://pubmed.ncbi.nlm.nih.gov/24393233/" target="_blank" rel="noopener">Vähä-Ypyä et al.,
2015</a>),</li>
<li>Activity Index (AI) (<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0160644" target="_blank" rel="noopener">Bai et al.,
2016</a>).</li>
</ul>
<p>In addition, attempts have been made to reverse-engineer proprietary
activity counts (AC) generated by ActiLife software from data collected
by ActiGraph accelerometers. These include:</p>
<ul>
<li><code>activityCounts</code> R package – allows generating “ActiLife counts from
raw acceleration data for different accelerometer brands and it is
developed based on the study done by <a href="https://pubmed.ncbi.nlm.nih.gov/28604558/" target="_blank" rel="noopener">Brond et al.,
2017</a>”.</li>
</ul>
<h3 id="summarizedactigraphy-r-package">SummarizedActigraphy R package</h3>
<p>We derive the measures using <code>SummarizedActigraphy</code> R package. The
package was authored by <a href="https://github.com/muschellij2" target="_blank" rel="noopener">John Muschelli</a>
and is available on GitHub
(<a href="https://github.com/muschellij2/SummarizedActigraphy" target="_blank" rel="noopener">link</a>).</p>
<p>It uses some of the existing R software under the hood to compute some
part of the measures:</p>
<ul>
<li><code>MIMSunit</code> R package to compute MIMS,</li>
<li><code>activityCounts</code> R package to compute AC.</li>
</ul>
<p>It computes some other measures straightfoward from their definition,
e.g.: MAD, AI.</p>
<h3 id="preparing-the-data-input">Preparing the data input</h3>
<p>We use raw accelerometry data from a wrist-worn sensor.</p>
<details>
<summary>
(Click to see notes and code.)
</summary>
<p>Note:</p>
<ul>
<li><code>SummarizedActigraphy</code> R package needs data with observation
timestamp in the form of <code>POSIXct</code> class. This timestamp column must
be named <code>HEADER_TIME_STAMP</code>; the specific column naming is needed
due to <a href="https://github.com/mHealthGroup/MIMSunit/issues/29" target="_blank" rel="noopener">some
issue</a> reported
for <code>MIMSunit</code> R package.</li>
<li>We hence create a “fake” <code>POSIXct</code> column named
<code>HEADER_TIME_STAMP</code>.</li>
<li>The option <code>options(digits.secs = 3)</code> was used on the top of this R
script to allow displaying decimal time part.</li>
</ul>
<p>We first demonstrate the code for one participant.</p>
<pre><code>dat_input_i &lt;- 
  dat_i %&gt;% 
  mutate(HEADER_TIME_STAMP = seq(from = ymd_hms(&quot;2021-01-01 00:00:00&quot;), by = 0.01, length.out = nrow(dat_i))) %&gt;%
  select(HEADER_TIME_STAMP, X = lw_x, Y = lw_y, Z = lw_z)
</code></pre>
</details>
<pre><code>dat_input_i

# A tibble: 303,300 x 4
   HEADER_TIME_STAMP            X      Y      Z
   &lt;dttm&gt;                   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 2021-01-01 00:00:00.000  0.039  1.02  -0.02 
 2 2021-01-01 00:00:00.009 -0.629 -0.461  0.973
 3 2021-01-01 00:00:00.019 -0.926 -1.26   0.691
 4 2021-01-01 00:00:00.029 -0.871 -1.50  -0.246
 5 2021-01-01 00:00:00.039 -0.727 -1.62  -0.559
 6 2021-01-01 00:00:00.049 -0.543 -1.66  -0.629
 7 2021-01-01 00:00:00.059 -0.348 -1.64  -0.609
 8 2021-01-01 00:00:00.069 -0.16  -1.60  -0.566
 9 2021-01-01 00:00:00.079 -0.012 -1.53  -0.523
10 2021-01-01 00:00:00.089  0.117 -1.43  -0.484
# … with 303,290 more rows
</code></pre>
<p>We use package’s helper function to check if sample rate is being
determined correctly (should be 100 Hz).</p>
<pre><code>get_sample_rate(dat_input_i)

[1] 100
</code></pre>
</details>
<h3 id="computing-the-measures">Computing the measures</h3>
<p>We calculate minute-level summary measures: AC, MIMS, MAD, AI. The
output shows values of the measures per each minute.</p>
<pre><code>out_i = SummarizedActigraphy::calculate_measures(
  df = dat_input_i, 
  dynamic_range = c(-8, 8),  # dynamic range
  fix_zeros = FALSE,         # fixes zeros from idle sleep mode -- not needed in our case 
  calculate_mims = TRUE,     # uses algorithm from MIMSunit package
  calculate_ac = TRUE,       # uses algorithm from activityCounts package 
  flag_data = FALSE,         # runs raw data quality control flags algorithm -- not used in our case  
  verbose = FALSE)

=================================================================================================================

out_i &lt;- out_i %&gt;% select(HEADER_TIME_STAMP = time, AC, MIMS = MIMS_UNIT, MAD, AI)
out_i

# A tibble: 51 x 5
   HEADER_TIME_STAMP            AC  MIMS     MAD    AI
   &lt;dttm&gt;                    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 2021-01-01 00:00:00.000  3623.  19.3  0.140    7.62
 2 2021-01-01 00:01:00.000  2460.  14.8  0.0971   5.84
 3 2021-01-01 00:02:00.000   648.   6.52 0.0192   2.44
 4 2021-01-01 00:03:00.000    36.2  1.86 0.00862  1.03
 5 2021-01-01 00:04:00.000  8084.  34.8  0.316   15.1 
 6 2021-01-01 00:05:00.000 13845.  60.1  0.358   25.3 
 7 2021-01-01 00:06:00.000 10549.  44.1  0.248   18.7 
 8 2021-01-01 00:07:00.000 11219.  45.8  0.244   19.6 
 9 2021-01-01 00:08:00.000 11624.  51.6  0.338   22.1 
10 2021-01-01 00:09:00.000 11049.  45.8  0.288   20.0 
# … with 41 more rows
</code></pre>
<p>Next, we calculate the measures for all n=32 subjects.</p>
<details>
<summary>
(Click to see the code.)
</summary>
<pre><code>out_all &lt;- data.frame()
for (dat_fpath_i in dat_fpaths){ #  dat_fpath_i &lt;- dat_fpaths[1]
  message(basename(dat_fpath_i))
  # read data 
  basename_i &lt;- gsub(&quot;.csv&quot;, &quot;&quot;, basename(dat_fpath_i))
  dat_i &lt;- read.csv(dat_fpath_i) 
  # prepare data input
  ts_i &lt;- seq(from = ymd_hms(&quot;2021-01-01 00:00:00&quot;), by = 0.01, length.out = nrow(dat_i))
  dat_input_i &lt;- 
    dat_i %&gt;% 
    mutate(HEADER_TIME_STAMP = ts_i) %&gt;%
    select(HEADER_TIME_STAMP, X = lw_x, Y = lw_y, Z = lw_z)
  # compute the measures 
  out_i = SummarizedActigraphy::calculate_measures(
    df = dat_input_i, 
    dynamic_range = c(-8, 8),  # dynamic range
    fix_zeros = FALSE,         # fixes zeros from idle sleep mode -- not needed in our case 
    calculate_mims = TRUE,     # uses algorithm from MIMSunit package
    calculate_ac = TRUE,       # uses algorithm from activityCounts package 
    flag_data = FALSE,         # runs raw data quality control flags algorithm -- not used in our case  
    verbose = FALSE)
  out_i &lt;- out_i %&gt;% select(HEADER_TIME_STAMP = time, AC, MIMS = MIMS_UNIT, MAD, AI)
  out_i &lt;- mutate(out_i, subj_id = basename_i, .before = everything())
  # append subject-specific measures to all subjects file 
  out_all &lt;- rbind(out_all, out_i)
}
</code></pre>
</details>
<h2 id="minute-level-physical-activity-measures-during-walking-and-driving-activities">Minute-level physical activity measures during walking and driving activities</h2>
<h3 id="merging-physical-activity-measures-with-physical-activity-labels">Merging physical activity measures with physical activity labels</h3>
<p>Next, we merge the minute-level physical-activity measures with the
activity labels. We only keep the minutes for which all the measurements
were labelled with no more than one type of activity.</p>
<details>
<summary>
(Click to see the code.)
</summary>
<pre><code>labels_df_all &lt;- data.frame()
for (dat_fpath_i in dat_fpaths){ #  dat_fpath_i &lt;- dat_fpaths[1]
  message(basename(dat_fpath_i))
  # read data 
  basename_i &lt;- gsub(&quot;.csv&quot;, &quot;&quot;, basename(dat_fpath_i))
  dat_i &lt;- read.csv(dat_fpath_i) 
  # aggregate activity labels
  ts_i &lt;- seq(from = ymd_hms(&quot;2021-01-01 00:00:00&quot;), by = 0.01, length.out = nrow(dat_i))
  labels_df_i &lt;- 
    dat_i %&gt;% 
    mutate(HEADER_TIME_STAMP = ts_i) %&gt;%
    mutate(HEADER_TIME_STAMP = lubridate::floor_date(HEADER_TIME_STAMP, &quot;1 min&quot;)) %&gt;%
    group_by(HEADER_TIME_STAMP) %&gt;%
    filter(n_distinct(activity) == 1) %&gt;%
    filter(row_number() == 1) %&gt;%
    # 1=walking; 2=descending stairs; 3=ascending stairs; 4=driving
    filter(activity %in% c(1,2,3,4)) %&gt;%
    ungroup() %&gt;%
    select(HEADER_TIME_STAMP, activity) 
  labels_df_i &lt;- mutate(labels_df_i, subj_id = basename_i, .before = everything())
  # append subject-specific measures to all subjects file 
  labels_df_all &lt;- rbind(labels_df_all, labels_df_i)
}
# recode activity label
labels_df_all &lt;- labels_df_all %&gt;%
  mutate(activity = recode(activity, '1' = 'walking', '2' = 'descending_stairs', 
                           '3' = 'ascending_stairs', '4' = 'driving'))

# merge: 
# (1) physical activity minute-level measures, 
# (2) physical activity minute-level activity labels
out_all_merged &lt;- 
  out_all %&gt;% 
  inner_join(labels_df_all, by = c(&quot;subj_id&quot;, &quot;HEADER_TIME_STAMP&quot;)) 
</code></pre>
</details>
<pre><code>out_all_merged

# A tibble: 686 x 7
   subj_id    HEADER_TIME_STAMP           AC  MIMS    MAD    AI activity
   &lt;chr&gt;      &lt;dttm&gt;                   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   
 1 id00b70b13 2021-01-01 00:06:00.000 10549. 44.1  0.248  18.7  walking 
 2 id00b70b13 2021-01-01 00:07:00.000 11219. 45.8  0.244  19.6  walking 
 3 id00b70b13 2021-01-01 00:11:00.000 11026. 42.3  0.215  18.9  walking 
 4 id00b70b13 2021-01-01 00:12:00.000 10561. 42.1  0.231  19.1  walking 
 5 id00b70b13 2021-01-01 00:13:00.000 13297. 53.9  0.325  23.1  walking 
 6 id00b70b13 2021-01-01 00:21:00.000  2603. 14.5  0.0413  4.80 driving 
 7 id00b70b13 2021-01-01 00:23:00.000   499.  6.65 0.0537  3.59 driving 
 8 id00b70b13 2021-01-01 00:24:00.000   398.  6.06 0.0496  3.49 driving 
 9 id00b70b13 2021-01-01 00:25:00.000   130.  5.92 0.0560  3.67 driving 
10 id00b70b13 2021-01-01 00:26:00.000   414.  7.00 0.0561  3.55 driving 
# … with 676 more rows

table(out_all_merged$activity)


driving walking 
    569     117 
</code></pre>
<h3 id="visualizing-physical-activity-measures-across-activity-types">Visualizing physical activity measures across activity types</h3>
<p>We visualize values of minute-level physical activity measures. Note
these only used data collected with a sensor located at left wrist.</p>
<details>
<summary>
(Click to see the code.)
</summary>
<pre><code>name_levels &lt;- c(&quot;AC&quot;, &quot;MIMS&quot;, &quot;MAD&quot;, &quot;AI&quot;)
activity_levels &lt;- c(&quot;walking&quot;, &quot;driving&quot;)
# define data subsets with one activity type only 
df_walk &lt;- out_all_merged %&gt;% filter(activity == &quot;walking&quot;) 
df_driv &lt;- out_all_merged %&gt;% filter(activity == &quot;driving&quot;)
# estimate sample population mean for each measure via LMM
measure_mean_vals &lt;- c(
  # walking 
  fixef(lmer(AC ~ (1 | subj_id), data = df_walk))[1],
  fixef(lmer(MIMS ~ (1 | subj_id), data = df_walk))[1],
  fixef(lmer(MAD ~ (1 | subj_id), data = df_walk))[1],
  fixef(lmer(AI ~ (1 | subj_id), data = df_walk))[1],
   # driving 
  fixef(lmer(AC ~ (1 | subj_id), data = df_driv))[1],
  fixef(lmer(MIMS ~ (1 | subj_id), data = df_driv))[1],
  fixef(lmer(MAD ~ (1 | subj_id), data = df_driv))[1],
  fixef(lmer(AI ~ (1 | subj_id), data = df_driv))[1]
)
measure_mean_df &lt;- data.frame(
  value = measure_mean_vals,
  name = rep(name_levels, times = 2),
  activity = rep(activity_levels, each = 4)
)
measure_mean_df_w &lt;- 
  measure_mean_df %&gt;%
  mutate(value = round(value, 2)) %&gt;% 
  pivot_wider(names_from = activity)
# define subject-specific means 
out_all_l &lt;- 
  out_all_merged %&gt;%
  pivot_longer(cols = all_of(name_levels)) 
out_all_l_agg &lt;- 
  out_all_l %&gt;%
  group_by(subj_id, name, activity) %&gt;%
  summarise(value = mean(value))
subj_id_levels &lt;- 
  out_all_l_agg %&gt;%
  filter(name == &quot;AC&quot;, activity == &quot;walking&quot;) %&gt;%
  arrange(desc(value)) %&gt;%
  pull(subj_id)
# mutate data frames used on the plot to have factors at certain levels order
measure_mean_df &lt;- 
  measure_mean_df %&gt;%
  mutate(activity = factor(activity, levels = activity_levels)) %&gt;%
  mutate(name = factor(name, levels = name_levels))
out_all_l &lt;- 
  out_all_l %&gt;%
  mutate(subj_id = factor(subj_id, levels = subj_id_levels),
         activity = factor(activity, levels = activity_levels)) %&gt;%
  mutate(name = factor(name, levels = name_levels))
out_all_l_agg &lt;-
  out_all_l_agg %&gt;%
   mutate(subj_id = factor(subj_id, levels = subj_id_levels),
         activity = factor(activity, levels = activity_levels)) %&gt;%
  mutate(name = factor(name, levels = name_levels))
</code></pre>
</details>
<p>First, we estimated sample population mean for each minute-level measure
via linear mixed model (LMM).</p>
<pre><code>kable(measure_mean_df_w)
</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">walking</th>
<th style="text-align: right;">driving</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AC</td>
<td style="text-align: right;">7616.48</td>
<td style="text-align: right;">801.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">MIMS</td>
<td style="text-align: right;">34.86</td>
<td style="text-align: right;">7.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MAD</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">AI</td>
<td style="text-align: right;">15.01</td>
<td style="text-align: right;">3.31</td>
</tr>
</tbody>
</table>
<p>Next, we plot minute-level physical activity measures:</p>
<ul>
<li>individual measure values (red) for each subject,</li>
<li>mean measure value (black) for each subject,</li>
<li>sample population mean for each measure (dashed horizontal line)
estimated via LMM.</li>
</ul>
<p>On each plot panel, subject IDs (x-axis) are sorted by average AC during
walking (left-top plot panel).</p>
<details>
<summary>
(Click to see the code.)
</summary>
<pre><code>plt_measures &lt;- 
  ggplot(out_all_l, 
         aes(x = subj_id, y = value)) + 
  geom_hline(data = measure_mean_df,
             aes(yintercept = value), 
             linetype = 2, size = 0.2) + 
  geom_point(size = 0.5, alpha = 0.3, color = &quot;red&quot;) + 
  geom_point(data = out_all_l_agg, 
             aes(x = subj_id, y = value),
             size = 0.5, color = &quot;black&quot;) + 
  facet_grid(name ~ activity, scales = &quot;free&quot;) + 
  labs(x = &quot;Subject ID&quot;, y = &quot;&quot;) + 
  theme_gray(base_size = 14) +    
  theme(panel.grid.major = element_line(size = 0.3),  
        panel.grid.minor = element_blank(),
        axis.text.x = element_text(size = 6, angle = 90, vjust = 0.5, hjust = 1)) 
</code></pre>
</details>
<pre><code>plt_measures
</code></pre>
<p><img src="plt_measures.png" alt=""></p>
<p>The above plot highlights what are minute-level summary measures of
physical activity from raw accelerometry data: AC, MIMS, MAD, and AI,
across two different activities (walking, driving) in the study sample
of n=32 healthy individuals.</p>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>I’d like to thank <a href="https://github.com/muschellij2" target="_blank" rel="noopener">John Muschelli</a> for
feedback on this tutorial.</p>
<h2 id="span-stylecolorredcitation-infospan"><span style="color:red">Citation info</span></h2>
<p>Please cite <code>SummarizedActigraphy</code> R package, if applicable.</p>
<p>Please cite raw accelerometry dataset DOI, if applicable (go to see
<a href="https://physionet.org/content/accelerometry-walk-climb-drive/1.0.0/" target="_blank" rel="noopener">this dataset citation
options</a>).</p>
    </div>

    








<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/2021-06-29-pa_measures_and_summarizedactigraphy/&amp;text=Computing%20minute-level%20summary%20measures%20of%20physical%20activity%20from%20raw%20accelerometry%20data%20in%20R:%20AC,%20MIMS,%20MAD,%20and%20AI" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/2021-06-29-pa_measures_and_summarizedactigraphy/&amp;t=Computing%20minute-level%20summary%20measures%20of%20physical%20activity%20from%20raw%20accelerometry%20data%20in%20R:%20AC,%20MIMS,%20MAD,%20and%20AI" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Computing%20minute-level%20summary%20measures%20of%20physical%20activity%20from%20raw%20accelerometry%20data%20in%20R:%20AC,%20MIMS,%20MAD,%20and%20AI&amp;body=/post/2021-06-29-pa_measures_and_summarizedactigraphy/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/2021-06-29-pa_measures_and_summarizedactigraphy/&amp;title=Computing%20minute-level%20summary%20measures%20of%20physical%20activity%20from%20raw%20accelerometry%20data%20in%20R:%20AC,%20MIMS,%20MAD,%20and%20AI" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Computing%20minute-level%20summary%20measures%20of%20physical%20activity%20from%20raw%20accelerometry%20data%20in%20R:%20AC,%20MIMS,%20MAD,%20and%20AI%20/post/2021-06-29-pa_measures_and_summarizedactigraphy/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/2021-06-29-pa_measures_and_summarizedactigraphy/&amp;title=Computing%20minute-level%20summary%20measures%20of%20physical%20activity%20from%20raw%20accelerometry%20data%20in%20R:%20AC,%20MIMS,%20MAD,%20and%20AI" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="/"><img class="avatar mr-3 avatar-circle" src="/author/marta-karas/avatar_hud72ccb91bce59b1d73702ea67c67cfd3_241597_270x270_fill_q90_lanczos_center.jpeg" alt="Marta Karas"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Marta Karas</a></h5>
      <h6 class="card-subtitle">PhD candidate in Biostatistics</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/martakarass" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=S27sttcAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="fas fa-graduation-cap"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/martakarass" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/martakaras/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.a30e17c6197f21f7f966f9a6cd022a55.js"></script>

    






</body>
</html>
