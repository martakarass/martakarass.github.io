<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.0 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Marta Karas">

  
  
  
    
  
  <meta name="description" content="In this post, we use the Repeated Measures Correlation (rmcorr) approach to quantify association between two continuous measures recorded multiple times per study subject.
I recently learned about the rmcorr approach and explored it with a view of applying in one of the current projects.">

  
  <link rel="alternate" hreflang="en-us" href="/post/2022-04-27-rmcorr_vs_lmm/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111897145-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-111897145-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/post/2022-04-27-rmcorr_vs_lmm/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Home">
  <meta property="og:url" content="/post/2022-04-27-rmcorr_vs_lmm/">
  <meta property="og:title" content="Repeated Measures Correlation (rmcorr): when may be not an ideal choice to quantify the association | Home">
  <meta property="og:description" content="In this post, we use the Repeated Measures Correlation (rmcorr) approach to quantify association between two continuous measures recorded multiple times per study subject.
I recently learned about the rmcorr approach and explored it with a view of applying in one of the current projects."><meta property="og:image" content="/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2022-04-26T17:19:28-04:00">
    
    <meta property="article:modified_time" content="2022-04-26T17:19:28-04:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/2022-04-27-rmcorr_vs_lmm/"
  },
  "headline": "Repeated Measures Correlation (rmcorr): when may be not an ideal choice to quantify the association",
  
  "datePublished": "2022-04-26T17:19:28-04:00",
  "dateModified": "2022-04-26T17:19:28-04:00",
  
  "author": {
    "@type": "Person",
    "name": "Marta Karas"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Home",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hufdd866d90d76849587aac6fbf27da1ac_464_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "In this post, we use the Repeated Measures Correlation (rmcorr) approach to quantify association between two continuous measures recorded multiple times per study subject.\nI recently learned about the rmcorr approach and explored it with a view of applying in one of the current projects."
}
</script>

  

  


  


  





  <title>Repeated Measures Correlation (rmcorr): when may be not an ideal choice to quantify the association | Home</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
    <script>window.wcDarkLightEnabled = true;</script>
  
  
    <script>const isSiteThemeDark = false;</script>
  
  
  <script src="/js/load-theme.js"></script>

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Home</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Home</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#resources"><span>Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/docs/mkaras_cv.pdf"><span>CV</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Repeated Measures Correlation (rmcorr): when may be not an ideal choice to quantify the association</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Apr 26, 2022
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    11 min read
  </span>
  

  
  
  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>In this post, we use the Repeated Measures Correlation (<em><strong>rmcorr</strong></em>) approach to quantify association between two continuous measures recorded multiple times per study subject.</p>
<p>I recently learned about the <em><strong>rmcorr</strong></em> approach and explored it with a view of applying in one of the current projects. I think <em><strong>rmcorr</strong></em> is a very interesting method with neat interpretation. Here, I highlight my key notes from how the <em><strong>rmcorr</strong></em> works, and I point to a few cases where I expect that <em><strong>rmcorr</strong></em> may be not an ideal choice to quantify the association.</p>
<h2>Table of Contents</h2>
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#method">Method</a></li>
        <li><a href="#key-notes">Key notes</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#scenario-1a">Scenario 1a</a></li>
        <li><a href="#scenario-1b">Scenario 1b</a></li>
        <li><a href="#scenario-2a">Scenario 2a</a></li>
        <li><a href="#scenario-2b">Scenario 2b</a></li>
        <li><a href="#scenario-3a">Scenario 3a</a></li>
        <li><a href="#scenario-3b">Scenario 3b</a></li>
        <li><a href="#scenario-4a">Scenario 4a</a></li>
        <li><a href="#scenario-4b">Scenario 4b</a></li>
      </ul>
    </li>
  </ul>
</nav>
<h1 id="repeated-measures-correlation">Repeated Measures Correlation</h1>
<p>The Bakdash et al. (2017) paper <a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2017.00456/full" target="_blank" rel="noopener">Repeated Measures
Correlation</a>
discusses within-participants correlation to analyze the common
intra-individual association for paired repeated measures. The paper
provides background information, methods description, R package
reference, and discussion on tradeoffs with <em><strong>rmcorr</strong></em> as compared to
multilevel modeling.</p>
<h3 id="method">Method</h3>
<p>In short, <em><strong>rmcorr</strong></em>:</p>
<ul>
<li>Is based on ANCOVA analysis: it considers a subject as a factor-level variable to remove between-person variation. ANCOVA model is set to estimate subjects' common regression slope $\beta$.</li>
<li>The rmcorr correlation coefficient is calculated using sums of squares for the Measure and for the error from the above ANCOVA model and its sign is determined by the sign (positive vs. negative) of estimated $\beta$.</li>
<li>It has a nice, intuitive interpretation.</li>
<li>Authors argue is &ldquo;comparable to linear multilevel model (<em><strong>LMM</strong></em>) with random intercept only and a fixed effect&rdquo;.</li>
</ul>
<h3 id="key-notes">Key notes</h3>
<p>Key notes on <em><strong>rmcorr</strong></em>:</p>
<ul>
<li><em><strong>rmcorr</strong></em> does not allow for slope variation by subject,</li>
<li><em><strong>rmcorr</strong></em> does not utilize any of <em><strong>LMM</strong></em>&rsquo;s partial-pooling idea (i.e., where for subjects with a relatively smaller number of observations, their estimates are &ldquo;shrunk&rdquo; closer to the overall population average);</li>
</ul>
<p>and hence, as the authors noted, <em><strong>rmcorr</strong></em> may be not an ideal choice to quantify the association:</p>
<ul>
<li>when the effect slope varies between subjects.</li>
</ul>
<p>I also thought having random slopes is even more problematic:</p>
<ul>
<li>when the number of observations varies between subjects (e.g., varies between 2-10),</li>
<li>when there are influential observation(s) (e.g., subject(s) with wide $x$ values range).</li>
</ul>
<h1 id="scenarios">Scenarios</h1>
<p>To illustrate the above notes, 4x2 simple data scenarios are considered.</p>
<ul>
<li>In each scenario, data on N = 20 subjects with 2 continuous variables ($x$, $y$), recorded at multiple occasions for each subject, are simulated.</li>
<li>The scenarios differ in true data-generating model that is assumed:
<ul>
<li>Scenario 1: random intercept only;</li>
<li>Scenario 2: random intercept and random slope (uncorrelated);</li>
<li>Scenario 3: random intercept and random slope (uncorrelated), added one subject with influential observations;</li>
<li>Scenario 4: random intercept and random slope (uncorrelated), unbalanced number of observations per subject.</li>
</ul>
</li>
<li>For each scenario, two versions are considered, assuming: (a): small variance of residual error; (b) large variance of residual error.</li>
</ul>
<p>To show the results:</p>
<ul>
<li>For each scenario, 1 data set is used and results from applying 2 approaches are shown:
<ul>
<li>left plot: <em><strong>rmcorr</strong></em> with an estimate of &ldquo;repeated measures correlation&rdquo;,</li>
<li>right plot: <em><strong>LMM</strong></em> fit with an estimate of fixed effect slope.</li>
</ul>
</li>
<li>For all scenarios, left plot points same as right plot points (the same data used for 2 approaches).</li>
<li>For all scenarios, population-level effect $x$ on $y$ was assumed to be equal $2.0$.</li>
<li>For all scenarios, <em><strong>LMM</strong></em> assumes random intercept and random slope for $x$, and a fixed effect for $x$.</li>
</ul>
<details>
<summary>
(Click to see R code shared for all simulations.)
</summary>
<pre><code>library(tidyverse)
library(lme4)
library(lmerTest)
library(rmcorr)
library(MASS)

# define simulation parameters
# number of subjects 
M &lt;- 20 
# number of repeated measures per subjects (for all except last two scenarios)
k &lt;- 5  

#' Function to apply two approaches to `dat` data set: 
#' (1) rmcorr with an estimate of &quot;repeated measures correlation&quot;,
#' (2) LMM fit with an estimate of fixed effect slope 
est_and_plot &lt;- function(dat){
  # approach 1 
  rmcorr_out &lt;- rmcorr(subj_id, x, y, dat)
  plt_label &lt;- paste0(&quot;r = &quot;, round(rmcorr_out$r, 3), &quot; (95% CI: [&quot;, paste0(round(rmcorr_out$CI, 3), collapse = &quot;, &quot;), &quot;])&quot;)
  par(mar = rep(2, 4))
  plot(rmcorr_out, main = plt_label)
  
  # approach 2 
  lmm_out &lt;- lmer(y ~ x + (1 + x | subj_id), data = dat)
  conf_est &lt;- summary(lmm_out)$coef[2, 1]
  conf_out &lt;- as.vector(confint(lmm_out, parm = &quot;x&quot;))
  plt_label &lt;- paste0(&quot;beta = &quot;, round(conf_est, 3), &quot; (95% CI: [&quot;, paste0(round(conf_out, 3), collapse = &quot;, &quot;), &quot;])&quot;)
  dat$mu &lt;- getME(lmm_out, &quot;mu&quot;)[1 : nrow(dat)]
  plt &lt;- 
    ggplot(dat, aes(x = x, y = y, color = subj_id, group = subj_id)) + 
    # geom_line(color = &quot;black&quot;) + 
    geom_line(aes(x = x, y = mu), size = 0.3) + 
    geom_point() + 
    theme_classic(base_size = 12) + 
    theme(
      legend.position = &quot;none&quot;,
    )  + 
    labs(x = &quot;x&quot;, y = &quot;y&quot;, title = plt_label)
  plot(plt) 
}
</code></pre>
</details>
</br>
<h3 id="scenario-1a">Scenario 1a</h3>
<p>Data-generating model:</p>
<ul>
<li>random intercept only</li>
<li>small residual error</li>
</ul>
<details>
<summary>
(Click to see R code.)
</summary>
<pre><code>set.seed(1)
eps_sd &lt;- 0.25
alpha = 1
beta = 2
ai = rnorm(M, mean = 0, sd = 3)
bi = rnorm(M, mean = 0, sd = 0)

subj_id_vec &lt;- numeric()
x_vec &lt;- numeric()
y_vec &lt;- numeric()
for (i in 1 : M){ # i &lt;- 2
  x_a &lt;- runif(1, 0, 5)
  x_b &lt;- x_a + 2 + rnorm(1)
  x &lt;- seq(x_a, x_b, length.out = k)
  eps &lt;- rnorm(k, mean = 0, sd = eps_sd)
  y &lt;- (alpha + ai[i]) + (beta + bi[i]) * x + eps
  subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k))
  x_vec &lt;- c(x_vec, x)
  y_vec &lt;- c(y_vec, y)
}
dat &lt;- data.frame(subj_id = factor(subj_id_vec), x = x_vec, y = y_vec)
est_and_plot(dat)
</code></pre>
</details>
</br>
<table>
<thead>
<tr>
<th>rmcorr</th>
<th>LMM</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="scenario_1a_plot-1.png" alt=""></td>
<td><img src="scenario_1a_plot-2.png" alt=""></td>
</tr>
</tbody>
</table>
<h3 id="scenario-1b">Scenario 1b</h3>
<p>Data-generating model:</p>
<ul>
<li>random intercept only</li>
<li>large residual error</li>
</ul>
<details>
<summary>
(Click to see R code.)
</summary>
<pre><code>set.seed(1)
eps_sd &lt;- 2
alpha = 1
beta = 2
ai = rnorm(M, mean = 0, sd = 3)
bi = rnorm(M, mean = 0, sd = 0)

subj_id_vec &lt;- numeric()
x_vec &lt;- numeric()
y_vec &lt;- numeric()
for (i in 1 : M){ # i &lt;- 2
  x_a &lt;- runif(1, 0, 5)
  x_b &lt;- x_a + 2 + rnorm(1)
  x &lt;- seq(x_a, x_b, length.out = k)
  eps &lt;- rnorm(k, mean = 0, sd = eps_sd)
  y &lt;- (alpha + ai[i]) + (beta + bi[i]) * x + eps
  subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k))
  x_vec &lt;- c(x_vec, x)
  y_vec &lt;- c(y_vec, y)
}
dat &lt;- data.frame(subj_id = factor(subj_id_vec), x = x_vec, y = y_vec)
est_and_plot(dat)
</code></pre>
</details>
</br>
<table>
<thead>
<tr>
<th>rmcorr</th>
<th>LMM</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="scenario_1b_plot-1.png" alt=""></td>
<td><img src="scenario_1b_plot-2.png" alt=""></td>
</tr>
</tbody>
</table>
<h3 id="scenario-2a">Scenario 2a</h3>
<p>Data-generating model:</p>
<ul>
<li>random intercept and random slope (uncorrelated)</li>
<li>small residual error</li>
</ul>
<details>
<summary>
(Click to see R code.)
</summary>
<pre><code>set.seed(1)
eps_sd &lt;- 0.25
alpha = 1
beta = 2
ai = rnorm(M, mean = 0, sd = 3)
bi = rnorm(M, mean = 0, sd = 1.5)

subj_id_vec &lt;- numeric()
x_vec &lt;- numeric()
y_vec &lt;- numeric()
for (i in 1 : M){ # i &lt;- 2
  x_a &lt;- runif(1, 0, 5)
  x_b &lt;- x_a + 2 + rnorm(1)
  x &lt;- seq(x_a, x_b, length.out = k)
  eps &lt;- rnorm(k, mean = 0, sd = eps_sd)
  y &lt;- (alpha + ai[i]) + (beta + bi[i]) * x + eps
  subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k))
  x_vec &lt;- c(x_vec, x)
  y_vec &lt;- c(y_vec, y)
}
dat &lt;- data.frame(subj_id = factor(subj_id_vec), x = x_vec, y = y_vec)
est_and_plot(dat)
</code></pre>
</details>
</br>
<table>
<thead>
<tr>
<th>rmcorr</th>
<th>LMM</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="scenario_2a_plot-1.png" alt=""></td>
<td><img src="scenario_2a_plot-2.png" alt=""></td>
</tr>
</tbody>
</table>
<h3 id="scenario-2b">Scenario 2b</h3>
<p>Data-generating model:</p>
<ul>
<li>random intercept and random slope (uncorrelated)</li>
<li>large residual error</li>
</ul>
<details>
<summary>
(Click to see R code.)
</summary>
<pre><code>set.seed(1)
eps_sd &lt;- 2
alpha = 1
beta = 2
ai = rnorm(M, mean = 0, sd = 3)
bi = rnorm(M, mean = 0, sd = 1.5)

subj_id_vec &lt;- numeric()
x_vec &lt;- numeric()
y_vec &lt;- numeric()
for (i in 1 : M){ # i &lt;- 2
  x_a &lt;- runif(1, 0, 5)
  x_b &lt;- x_a + 2 + rnorm(1)
  x &lt;- seq(x_a, x_b, length.out = k)
  eps &lt;- rnorm(k, mean = 0, sd = eps_sd)
  y &lt;- (alpha + ai[i]) + (beta + bi[i]) * x + eps
  subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k))
  x_vec &lt;- c(x_vec, x)
  y_vec &lt;- c(y_vec, y)
}
dat &lt;- data.frame(subj_id = factor(subj_id_vec), x = x_vec, y = y_vec)
est_and_plot(dat)
</code></pre>
</details>
</br>
<table>
<thead>
<tr>
<th>rmcorr</th>
<th>LMM</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="scenario_2b_plot-1.png" alt=""></td>
<td><img src="scenario_2b_plot-2.png" alt=""></td>
</tr>
</tbody>
</table>
<h3 id="scenario-3a">Scenario 3a</h3>
<p>Data-generating model:</p>
<ul>
<li>random intercept and random slope (uncorrelated)</li>
<li>small residual error</li>
<li>add one influential observation (wide x-axis range, simulate 0 $x$
effect on $y$ for that subject)</li>
</ul>
<details>
<summary>
(Click to see R code.)
</summary>
<pre><code>set.seed(1)
eps_sd &lt;- 0.25
alpha = 1
beta = 2
ai = rnorm(M, mean = 0, sd = 3)
bi = rnorm(M, mean = 0, sd = 1.5)

subj_id_vec &lt;- numeric()
x_vec &lt;- numeric()
y_vec &lt;- numeric()
for (i in 1 : (M-1)){ # i &lt;- 2
  x_a &lt;- runif(1, 0, 5)
  x_b &lt;- x_a + 2 + rnorm(1)
  x &lt;- seq(x_a, x_b, length.out = k)
  eps &lt;- rnorm(k, mean = 0, sd = eps_sd)
  y &lt;- (alpha + ai[i]) + (beta + bi[i]) * x + eps
  subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k))
  x_vec &lt;- c(x_vec, x)
  y_vec &lt;- c(y_vec, y)
}
i &lt;- M
x_a &lt;- runif(1, 0, 5)
x_b &lt;- x_a + 15
x &lt;- seq(x_a, x_b, length.out = k)
eps &lt;- rnorm(k, mean = 0, sd = eps_sd)
# y &lt;- (alpha + ai[i]) + rep(0, k) + eps
y &lt;- alpha + rep(0, k) + eps
subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k))
x_vec &lt;- c(x_vec, x)
y_vec &lt;- c(y_vec, y)
dat &lt;- data.frame(subj_id = factor(subj_id_vec), x = x_vec, y = y_vec)
est_and_plot(dat)
</code></pre>
</details>
</br>
<table>
<thead>
<tr>
<th>rmcorr</th>
<th>LMM</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="scenario_3a_plot-1.png" alt=""></td>
<td><img src="scenario_3a_plot-2.png" alt=""></td>
</tr>
</tbody>
</table>
<h3 id="scenario-3b">Scenario 3b</h3>
<p>Data-generating model:</p>
<ul>
<li>random intercept and random slope (uncorrelated)</li>
<li>large residual error</li>
<li>add one influential observation (wide x-axis range, simulate 0 $x$
effect on $y$ for that subject)</li>
</ul>
<details>
<summary>
(Click to see R code.)
</summary>
<pre><code>set.seed(1)
eps_sd &lt;- 2
alpha = 1
beta = 2
ai = rnorm(M, mean = 0, sd = 3)
bi = rnorm(M, mean = 0, sd = 1.5)

subj_id_vec &lt;- numeric()
x_vec &lt;- numeric()
y_vec &lt;- numeric()
for (i in 1 : (M-1)){ # i &lt;- 2
  x_a &lt;- runif(1, 0, 5)
  x_b &lt;- x_a + 2 + rnorm(1)
  x &lt;- seq(x_a, x_b, length.out = k)
  eps &lt;- rnorm(k, mean = 0, sd = eps_sd)
  y &lt;- (alpha + ai[i]) + (beta + bi[i]) * x + eps
  subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k))
  x_vec &lt;- c(x_vec, x)
  y_vec &lt;- c(y_vec, y)
}
i &lt;- M
x_a &lt;- runif(1, 0, 5)
x_b &lt;- x_a + 15
x &lt;- seq(x_a, x_b, length.out = k)
eps &lt;- rnorm(k, mean = 0, sd = eps_sd)
# y &lt;- (alpha + ai[i]) + rep(0, k) + eps
y &lt;- (alpha + 0) + rep(0, k) + eps
subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k))
x_vec &lt;- c(x_vec, x)
y_vec &lt;- c(y_vec, y)
dat &lt;- data.frame(subj_id = factor(subj_id_vec), x = x_vec, y = y_vec)
est_and_plot(dat)
</code></pre>
</details>
</br>
<table>
<thead>
<tr>
<th>rmcorr</th>
<th>LMM</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="scenario_3b_plot-1.png" alt=""></td>
<td><img src="scenario_3b_plot-2.png" alt=""></td>
</tr>
</tbody>
</table>
<h3 id="scenario-4a">Scenario 4a</h3>
<p>Data-generating model:</p>
<ul>
<li>random intercept and random slope (uncorrelated)</li>
<li>small residual error</li>
<li>various number (between 2 and 8) of observations per subject</li>
</ul>
<details>
<summary>
(Click to see R code.)
</summary>
<pre><code>set.seed(1)
eps_sd &lt;- 0.25
alpha = 1
beta = 2
ai = rnorm(M, mean = 0, sd = 3)
bi = rnorm(M, mean = 0, sd = 1.5)

subj_id_vec &lt;- numeric()
x_vec &lt;- numeric()
y_vec &lt;- numeric()
for (i in 1 : M){ # i &lt;- 2
  k_i &lt;- sample(2 : 8, 1)
  x_a &lt;- runif(1, 0, 5)
  x_b &lt;- x_a + 2 + rnorm(1)
  x &lt;- seq(x_a, x_b, length.out = k_i)
  eps &lt;- rnorm(k_i, mean = 0, sd = eps_sd)
  y &lt;- (alpha + ai[i]) + (beta + bi[i]) * x + eps
  subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k_i))
  x_vec &lt;- c(x_vec, x)
  y_vec &lt;- c(y_vec, y)
}
dat &lt;- data.frame(subj_id = factor(subj_id_vec), x = x_vec, y = y_vec)
est_and_plot(dat)
</code></pre>
</details>
</br>
<table>
<thead>
<tr>
<th>rmcorr</th>
<th>LMM</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="scenario_4a_plot-1.png" alt=""></td>
<td><img src="scenario_4a_plot-2.png" alt=""></td>
</tr>
</tbody>
</table>
<h3 id="scenario-4b">Scenario 4b</h3>
<p>Data-generating model:</p>
<ul>
<li>random intercept and random slope (uncorrelated)</li>
<li>large residual error</li>
<li>various number (between 2 and 8) of observations per subject</li>
</ul>
<details>
<summary>
(Click to see R code.)
</summary>
<pre><code>set.seed(1)
eps_sd &lt;- 2
alpha = 1
beta = 2
ai = rnorm(M, mean = 0, sd = 3)
bi = rnorm(M, mean = 0, sd = 1.5)

subj_id_vec &lt;- numeric()
x_vec &lt;- numeric()
y_vec &lt;- numeric()
for (i in 1 : M){ # i &lt;- 2
  k_i &lt;- sample(2 : 8, 1)
  x_a &lt;- runif(1, 0, 5)
  x_b &lt;- x_a + 2 + rnorm(1)
  x &lt;- seq(x_a, x_b, length.out = k_i)
  eps &lt;- rnorm(k_i, mean = 0, sd = eps_sd)
  y &lt;- (alpha + ai[i]) + (beta + bi[i]) * x + eps
  subj_id_vec &lt;- c(subj_id_vec, rep(paste0(&quot;subj_id_&quot;, i), k_i))
  x_vec &lt;- c(x_vec, x)
  y_vec &lt;- c(y_vec, y)
}
dat &lt;- data.frame(subj_id = factor(subj_id_vec), x = x_vec, y = y_vec)
est_and_plot(dat)
</code></pre>
</details>
</br>
<table>
<thead>
<tr>
<th>rmcorr</th>
<th>LMM</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="scenario_4b_plot-1.png" alt=""></td>
<td><img src="scenario_4b_plot-2.png" alt=""></td>
</tr>
</tbody>
</table>
<h1 id="observations">Observations</h1>
<ul>
<li>
<p><strong>When the &ldquo;true&rdquo; effect slope varies between subjects</strong>, the estimated
<em><strong>rmcorr</strong></em> correlation, $r_{rm}$, might be tanking. See Scenario 2a
($r_{rm}$ = 0.652) and 2b ($r_{rm}$ = 0.458) where data-generating model
assumed varying slope, and compare with Scenario 1a ($r_{rm}$ = 0.992)
and 1b ($r_{rm}$ = 0.623) where data-generating model assumed the same
population-effect as 2a and 2b but no varying slope. </br></br></p>
</li>
<li>
<p><strong>In presence of influential observation</strong>, the estimated <em><strong>rmcorr</strong></em>
correlation, $r_{rm}$, appear to be prone to be further affected. See
Scenario 3a and 3b where influential observation was added (data for
one subject, assumed wide x-axis range, simulate 0 $x$ effect on $y$
for that subject). Compare scenario 2a and 3a ($r_{rm}$ = 0.652 =&gt;
$r_{rm}$ = 0.349) and Scenario 2b and 3b ($r_{rm}$ = 0.458 =&gt; $r_{rm}$ = 0.189)
where data-generating models within these pairs differ only by how
data for that one subject were simulated.  </br></br></p>
</li>
<li>
<p><strong>When number of observations</strong> varies between subjects (and especially
when it is small for some), due to lack of partial-pooling
mechanism, I expect <em><strong>rmcorr</strong></em> correlation results might be
unstable too. See Scenario 4a and 4b where various number (between 2
and 8) of observations per subject was assumed. Compare scenario 2a
and 4a ($r_{rm}$ = 0.652 =&gt; $r_{rm}$ = 0.885) and Scenario 2b and 4b
($r_{rm}$ = 0.458 =&gt; $r_{rm}$ = 0.594) which data-generating models only
differ by assuming fixed or variate number of observations per
subject (while the average number of observations per subject is set
the same).</p>
</li>
</ul>
<h1 id="conclusion">Conclusion</h1>
<p>In conclusion: <em><strong>rmcorr</strong></em> is IMO a very interesting method with neat &ldquo;repeated measures correlation interpretation&rdquo;. However, in some data scenarios demonstrated above, the correlation estmated by <em><strong>rmcorr</strong></em> might be not an ideal choice to quantify the association between two measures.</p>

    </div>

    








<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/2022-04-27-rmcorr_vs_lmm/&amp;text=Repeated%20Measures%20Correlation%20%28rmcorr%29:%20when%20may%20be%20not%20an%20ideal%20choice%20to%20quantify%20the%20association" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/2022-04-27-rmcorr_vs_lmm/&amp;t=Repeated%20Measures%20Correlation%20%28rmcorr%29:%20when%20may%20be%20not%20an%20ideal%20choice%20to%20quantify%20the%20association" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Repeated%20Measures%20Correlation%20%28rmcorr%29:%20when%20may%20be%20not%20an%20ideal%20choice%20to%20quantify%20the%20association&amp;body=/post/2022-04-27-rmcorr_vs_lmm/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/2022-04-27-rmcorr_vs_lmm/&amp;title=Repeated%20Measures%20Correlation%20%28rmcorr%29:%20when%20may%20be%20not%20an%20ideal%20choice%20to%20quantify%20the%20association" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Repeated%20Measures%20Correlation%20%28rmcorr%29:%20when%20may%20be%20not%20an%20ideal%20choice%20to%20quantify%20the%20association%20/post/2022-04-27-rmcorr_vs_lmm/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/2022-04-27-rmcorr_vs_lmm/&amp;title=Repeated%20Measures%20Correlation%20%28rmcorr%29:%20when%20may%20be%20not%20an%20ideal%20choice%20to%20quantify%20the%20association" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="/"><img class="avatar mr-3 avatar-circle" src="/author/marta-karas/avatar_hud72ccb91bce59b1d73702ea67c67cfd3_241597_270x270_fill_q90_lanczos_center.jpeg" alt="Marta Karas"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Marta Karas</a></h5>
      <h6 class="card-subtitle">Postdoctoral researcher</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/martakarass" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=S27sttcAAAAJ&amp;hl=en" target="_blank" rel="noopener">
        <i class="fas fa-graduation-cap"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/martakarass" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/martakaras/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/wowchemy.min.a30e17c6197f21f7f966f9a6cd022a55.js"></script>

    






</body>
</html>
